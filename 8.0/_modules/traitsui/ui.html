
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8">
    
    <title>traitsui.ui &mdash; TraitsUI 8 Documentation</title>
    
    <link rel="stylesheet" type="text/css" href="../../_static/css/spc-bootstrap.css">
    <link rel="stylesheet" type="text/css" href="../../_static/css/spc-extend.css">
    <link rel="stylesheet" href="../../_static/enthought.css" type="text/css" >
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" >
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" >
    <link rel="stylesheet" href="../../_static/enthought.css" type="text/css" >
    <link rel="stylesheet" href="../../_static/copybutton.css" type="text/css" >
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        LINK_SUFFIX: '.html',
        SOURCELINK_SUFFIX: '.txt',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/sphinx_highlight.js"></script>
    <script type="text/javascript" src="../../_static/clipboard.min.js"></script>
    <script type="text/javascript" src="../../_static/copybutton.js"></script>
    <script type="text/javascript" src="../../_static/js/copybutton.js"></script>
    <script type="text/javascript" src="../../_static/js/wrap_on_dot.js"></script>
    <link rel="shortcut icon" href="../../_static/img/favicon.png">
    <link rel="index" title="Index" href="../../genindex.html" >
    <link rel="search" title="Search" href="../../search.html" >
    <link rel="top" title="TraitsUI 8 Documentation" href="../../index.html" >
    <link rel="up" title="Module code" href="../index.html" > 
  </head>
  <body>
  <div class="container">
    <div class="header">
    </div>
  </div>

    <div class="container">
      <div class="main">
        
	<div class="row-fluid">
	  <div class="span12">
	    <div class="spc-navbar">
              
    <ul class="nav nav-pills pull-left">
	
        <li class="active"><a href="../../index.html">TraitsUI 8 Documentation</a></li>
	
          <li class="active"><a href="../index.html" accesskey="U">Module code</a></li>
  
    <li><a href="#">traitsui.ui</a></li>
  

    </ul>
              
              
    <ul class="nav nav-pills pull-right">
      <li class="active">
        <a href="../../genindex.html" title="General Index"
           accesskey="I">index</a>
      </li>
      <li class="active">
        <a href="../../py-modindex.html" title="Python Module Index"
           >modules</a>
      </li>
    </ul>
              
	    </div>
	  </div>
	</div>
        

	<div class="row-fluid">
          <div class="span9">
            
        <div class="bodywrapper">
          <div class="body" id="spc-section-body" role="main">
            
  <h1>Source code for traitsui.ui</h1><div class="highlight"><pre>
<span></span><span class="c1"># (C) Copyright 2004-2023 Enthought, Inc., Austin, TX</span>
<span class="c1"># All rights reserved.</span>
<span class="c1">#</span>
<span class="c1"># This software is provided without warranty under the terms of the BSD</span>
<span class="c1"># license included in LICENSE.txt and may be redistributed only under</span>
<span class="c1"># the conditions described in the aforementioned license. The license</span>
<span class="c1"># is also available online at http://www.enthought.com/licenses/BSD.txt</span>
<span class="c1">#</span>
<span class="c1"># Thanks for using Enthought open source!</span>

<span class="sd">&quot;&quot;&quot; Defines the UI class used to represent an active traits-based user</span>
<span class="sd">    interface.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">shelve</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">warnings</span> <span class="kn">import</span> <span class="n">warn</span>

<span class="kn">from</span> <span class="nn">pyface.ui_traits</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">from</span> <span class="nn">traits.api</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">Any</span><span class="p">,</span>
    <span class="n">Bool</span><span class="p">,</span>
    <span class="n">Callable</span><span class="p">,</span>
    <span class="n">Dict</span><span class="p">,</span>
    <span class="n">Event</span><span class="p">,</span>
    <span class="n">HasPrivateTraits</span><span class="p">,</span>
    <span class="n">Instance</span><span class="p">,</span>
    <span class="n">Int</span><span class="p">,</span>
    <span class="n">List</span><span class="p">,</span>
    <span class="n">Property</span><span class="p">,</span>
    <span class="n">Str</span><span class="p">,</span>
    <span class="n">TraitError</span><span class="p">,</span>
    <span class="n">observe</span><span class="p">,</span>
<span class="p">)</span>

<span class="kn">from</span> <span class="nn">traits.trait_base</span> <span class="kn">import</span> <span class="n">traits_home</span><span class="p">,</span> <span class="n">is_str</span>

<span class="kn">from</span> <span class="nn">.editor</span> <span class="kn">import</span> <span class="n">Editor</span>

<span class="kn">from</span> <span class="nn">.view_elements</span> <span class="kn">import</span> <span class="n">ViewElements</span>

<span class="kn">from</span> <span class="nn">.handler</span> <span class="kn">import</span> <span class="n">Handler</span><span class="p">,</span> <span class="n">ViewHandler</span>

<span class="kn">from</span> <span class="nn">.toolkit</span> <span class="kn">import</span> <span class="n">toolkit</span>

<span class="kn">from</span> <span class="nn">.ui_info</span> <span class="kn">import</span> <span class="n">UIInfo</span>

<span class="kn">from</span> <span class="nn">.item</span> <span class="kn">import</span> <span class="n">Item</span>

<span class="kn">from</span> <span class="nn">.group</span> <span class="kn">import</span> <span class="n">Group</span><span class="p">,</span> <span class="n">ShadowGroup</span>


<span class="c1"># List of **kind** types for views that must have a **parent** window specified</span>
<span class="n">kind_must_have_parent</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;panel&quot;</span><span class="p">,</span> <span class="s2">&quot;subpanel&quot;</span><span class="p">)</span>


<div class="viewcode-block" id="UI"><a class="viewcode-back" href="../../api/traitsui.ui.html#traitsui.ui.UI">[docs]</a><span class="k">class</span> <span class="nc">UI</span><span class="p">(</span><span class="n">HasPrivateTraits</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Information about the user interface for a View.&quot;&quot;&quot;</span>

    <span class="c1"># -------------------------------------------------------------------------</span>
    <span class="c1">#  Trait definitions:</span>
    <span class="c1"># -------------------------------------------------------------------------</span>

    <span class="c1">#: The ViewElements object from which this UI resolves Include items</span>
    <span class="n">view_elements</span> <span class="o">=</span> <span class="n">Instance</span><span class="p">(</span><span class="n">ViewElements</span><span class="p">)</span>

    <span class="c1">#: Context objects that the UI is editing</span>
    <span class="n">context</span> <span class="o">=</span> <span class="n">Dict</span><span class="p">(</span><span class="n">Str</span><span class="p">,</span> <span class="n">Any</span><span class="p">)</span>

    <span class="c1">#: Handler object used for event handling</span>
    <span class="n">handler</span> <span class="o">=</span> <span class="n">Instance</span><span class="p">(</span><span class="n">Handler</span><span class="p">)</span>

    <span class="c1">#: View template used to construct the user interface</span>
    <span class="n">view</span> <span class="o">=</span> <span class="n">Instance</span><span class="p">(</span><span class="s2">&quot;traitsui.view.View&quot;</span><span class="p">)</span>

    <span class="c1">#: Panel or dialog associated with the user interface</span>
    <span class="n">control</span> <span class="o">=</span> <span class="n">Any</span><span class="p">()</span>

    <span class="c1">#: The parent UI (if any) of this UI</span>
    <span class="n">parent</span> <span class="o">=</span> <span class="n">Instance</span><span class="p">(</span><span class="s2">&quot;UI&quot;</span><span class="p">)</span>

    <span class="c1">#: Toolkit-specific object that &quot;owns&quot; **control**</span>
    <span class="n">owner</span> <span class="o">=</span> <span class="n">Any</span><span class="p">()</span>

    <span class="c1">#: UIInfo object containing context or editor objects</span>
    <span class="n">info</span> <span class="o">=</span> <span class="n">Instance</span><span class="p">(</span><span class="n">UIInfo</span><span class="p">)</span>

    <span class="c1">#: Result from a modal or wizard dialog:</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">Bool</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1">#: Undo and Redo history</span>
    <span class="n">history</span> <span class="o">=</span> <span class="n">Any</span><span class="p">()</span>

    <span class="c1">#: The KeyBindings object (if any) for this UI:</span>
    <span class="n">key_bindings</span> <span class="o">=</span> <span class="n">Property</span><span class="p">(</span><span class="n">depends_on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;view._key_bindings&quot;</span><span class="p">,</span> <span class="s2">&quot;context&quot;</span><span class="p">])</span>

    <span class="c1">#: The unique ID for this UI for persistence</span>
    <span class="nb">id</span> <span class="o">=</span> <span class="n">Str</span><span class="p">()</span>

    <span class="c1">#: Have any modifications been made to UI contents?</span>
    <span class="n">modified</span> <span class="o">=</span> <span class="n">Bool</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1">#: Event when the user interface has changed</span>
    <span class="n">updated</span> <span class="o">=</span> <span class="n">Event</span><span class="p">(</span><span class="n">Bool</span><span class="p">)</span>

    <span class="c1">#: Title of the dialog, if any</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">Str</span><span class="p">()</span>

    <span class="c1">#: The ImageResource of the icon, if any</span>
    <span class="n">icon</span> <span class="o">=</span> <span class="n">Image</span>

    <span class="c1">#: Should the created UI have scroll bars?</span>
    <span class="n">scrollable</span> <span class="o">=</span> <span class="n">Bool</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1">#: The number of currently pending editor error conditions</span>
    <span class="n">errors</span> <span class="o">=</span> <span class="n">Int</span><span class="p">()</span>

    <span class="c1">#: The code used to rebuild an updated user interface</span>
    <span class="n">rebuild</span> <span class="o">=</span> <span class="n">Callable</span><span class="p">()</span>

    <span class="c1">#: Set to True when the UI has finished being destroyed.</span>
    <span class="n">destroyed</span> <span class="o">=</span> <span class="n">Bool</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># -- Private Traits -------------------------------------------------------</span>

    <span class="c1">#: Original context when used with a modal dialog</span>
    <span class="n">_context</span> <span class="o">=</span> <span class="n">Dict</span><span class="p">(</span><span class="n">Str</span><span class="p">,</span> <span class="n">Any</span><span class="p">)</span>

    <span class="c1">#: Copy of original context used for reverting changes</span>
    <span class="n">_revert</span> <span class="o">=</span> <span class="n">Dict</span><span class="p">(</span><span class="n">Str</span><span class="p">,</span> <span class="n">Any</span><span class="p">)</span>

    <span class="c1">#: List of methods to call once the user interface is created</span>
    <span class="n">_defined</span> <span class="o">=</span> <span class="n">List</span><span class="p">()</span>

    <span class="c1">#: List of (visible_when,Editor) pairs</span>
    <span class="n">_visible</span> <span class="o">=</span> <span class="n">List</span><span class="p">()</span>

    <span class="c1">#: List of (enabled_when,Editor) pairs</span>
    <span class="n">_enabled</span> <span class="o">=</span> <span class="n">List</span><span class="p">()</span>

    <span class="c1">#: List of (checked_when,Editor) pairs</span>
    <span class="n">_checked</span> <span class="o">=</span> <span class="n">List</span><span class="p">()</span>

    <span class="c1">#: Search stack used while building a user interface</span>
    <span class="n">_search</span> <span class="o">=</span> <span class="n">List</span><span class="p">()</span>

    <span class="c1">#: List of dispatchable Handler methods</span>
    <span class="n">_dispatchers</span> <span class="o">=</span> <span class="n">List</span><span class="p">()</span>

    <span class="c1">#: List of editors used to build the user interface</span>
    <span class="n">_editors</span> <span class="o">=</span> <span class="n">List</span><span class="p">()</span>

    <span class="c1">#: List of names bound to the **info** object</span>
    <span class="n">_names</span> <span class="o">=</span> <span class="n">List</span><span class="p">()</span>

    <span class="c1">#: Index of currently the active group in the user interface</span>
    <span class="n">_active_group</span> <span class="o">=</span> <span class="n">Int</span><span class="p">()</span>

    <span class="c1">#: List of top-level groups used to build the user interface</span>
    <span class="n">_groups</span> <span class="o">=</span> <span class="n">Property</span><span class="p">()</span>
    <span class="n">_groups_cache</span> <span class="o">=</span> <span class="n">Any</span><span class="p">()</span>

    <span class="c1">#: Count of levels of nesting for undoable actions</span>
    <span class="n">_undoable</span> <span class="o">=</span> <span class="n">Int</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1">#: Code used to rebuild an updated user interface</span>
    <span class="n">_rebuild</span> <span class="o">=</span> <span class="n">Callable</span><span class="p">()</span>

    <span class="c1">#: The statusbar listeners that have been set up:</span>
    <span class="n">_statusbar</span> <span class="o">=</span> <span class="n">List</span><span class="p">()</span>

    <span class="c1">#: Control which gets focus after UI is created</span>
    <span class="c1">#: Note: this does not track focus after UI creation</span>
    <span class="c1">#: only used by Qt backend.</span>
    <span class="n">_focus_control</span> <span class="o">=</span> <span class="n">Any</span><span class="p">()</span>

    <span class="c1">#: Does the UI contain any scrollable widgets?</span>
    <span class="c1">#:</span>
    <span class="c1">#: The _scrollable trait is set correctly, but not used currently because</span>
    <span class="c1">#: its value is arrived at too late to be of use in building the UI.</span>
    <span class="n">_scrollable</span> <span class="o">=</span> <span class="n">Bool</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1">#: Cache for key bindings.</span>
    <span class="n">_key_bindings</span> <span class="o">=</span> <span class="n">Instance</span><span class="p">(</span><span class="s2">&quot;traitsui.key_bindings.KeyBindings&quot;</span><span class="p">)</span>

    <span class="c1">#: List of traits that are reset when a user interface is recycled</span>
    <span class="c1">#: (i.e. rebuilt).</span>
    <span class="n">recyclable_traits</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;_context&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_revert&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_defined&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_visible&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_enabled&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_checked&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_search&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_dispatchers&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_editors&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_names&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_active_group&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_undoable&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_rebuild&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_groups_cache&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_key_bindings&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_focus_control&quot;</span><span class="p">,</span>
    <span class="p">]</span>

    <span class="c1">#: List of additional traits that are discarded when a user interface is</span>
    <span class="c1">#: disposed.</span>
    <span class="n">disposable_traits</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;view_elements&quot;</span><span class="p">,</span>
        <span class="s2">&quot;info&quot;</span><span class="p">,</span>
        <span class="s2">&quot;handler&quot;</span><span class="p">,</span>
        <span class="s2">&quot;context&quot;</span><span class="p">,</span>
        <span class="s2">&quot;view&quot;</span><span class="p">,</span>
        <span class="s2">&quot;history&quot;</span><span class="p">,</span>
        <span class="s2">&quot;key_bindings&quot;</span><span class="p">,</span>
        <span class="s2">&quot;icon&quot;</span><span class="p">,</span>
        <span class="s2">&quot;rebuild&quot;</span><span class="p">,</span>
    <span class="p">]</span>

<div class="viewcode-block" id="UI.traits_init"><a class="viewcode-back" href="../../api/traitsui.ui.html#traitsui.ui.UI.traits_init">[docs]</a>    <span class="k">def</span> <span class="nf">traits_init</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initializes the traits object.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">info</span> <span class="o">=</span> <span class="n">UIInfo</span><span class="p">(</span><span class="n">ui</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">handler</span><span class="o">.</span><span class="n">init_info</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">)</span></div>

<div class="viewcode-block" id="UI.ui"><a class="viewcode-back" href="../../api/traitsui.ui.html#traitsui.ui.UI.ui">[docs]</a>    <span class="k">def</span> <span class="nf">ui</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">kind</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Creates a user interface from the associated View template object.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">parent</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">kind</span> <span class="ow">in</span> <span class="n">kind_must_have_parent</span><span class="p">):</span>
            <span class="n">kind</span> <span class="o">=</span> <span class="s2">&quot;live&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">on_trait_change</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_updated_changed</span><span class="p">,</span> <span class="s2">&quot;updated&quot;</span><span class="p">,</span> <span class="n">dispatch</span><span class="o">=</span><span class="s2">&quot;ui&quot;</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rebuild</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">toolkit</span><span class="p">(),</span> <span class="s2">&quot;ui_&quot;</span> <span class="o">+</span> <span class="n">kind</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rebuild</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">)</span></div>

<div class="viewcode-block" id="UI.dispose"><a class="viewcode-back" href="../../api/traitsui.ui.html#traitsui.ui.UI.dispose">[docs]</a>    <span class="k">def</span> <span class="nf">dispose</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">result</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">abort</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Disposes of the contents of a user interface.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">errors</span> <span class="o">-=</span> <span class="bp">self</span><span class="o">.</span><span class="n">errors</span>

        <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">result</span> <span class="o">=</span> <span class="n">result</span>

        <span class="c1"># Only continue if the view has not already been disposed of:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">control</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Save the user preference information for the user interface:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">abort</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">save_prefs</span><span class="p">()</span>

            <span class="c1"># Finish disposing of the user interface:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">finish</span><span class="p">()</span></div>

<div class="viewcode-block" id="UI.recycle"><a class="viewcode-back" href="../../api/traitsui.ui.html#traitsui.ui.UI.recycle">[docs]</a>    <span class="k">def</span> <span class="nf">recycle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Recycles the user interface prior to rebuilding it.&quot;&quot;&quot;</span>
        <span class="c1"># Reset all user interface editors:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reset</span><span class="p">(</span><span class="n">destroy</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># Discard any context object associated with the ui view control:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">_object</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Reset all recyclable traits:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reset_traits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">recyclable_traits</span><span class="p">)</span></div>

<div class="viewcode-block" id="UI.finish"><a class="viewcode-back" href="../../api/traitsui.ui.html#traitsui.ui.UI.finish">[docs]</a>    <span class="k">def</span> <span class="nf">finish</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Finishes disposing of a user interface.&quot;&quot;&quot;</span>
        <span class="c1"># Destroy the control early to silence cascade events when the UI</span>
        <span class="c1"># enters an inconsistent state.</span>
        <span class="n">toolkit</span><span class="p">()</span><span class="o">.</span><span class="n">destroy_control</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">control</span><span class="p">)</span>

        <span class="c1"># Reset the contents of the user interface</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reset</span><span class="p">(</span><span class="n">destroy</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># Make sure that &#39;visible&#39;, &#39;enabled&#39;, and &#39;checked&#39; handlers are not</span>
        <span class="c1"># called after the editor has been disposed:</span>
        <span class="k">for</span> <span class="nb">object</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="nb">object</span><span class="o">.</span><span class="n">on_trait_change</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_evaluate_when</span><span class="p">,</span> <span class="n">remove</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Notify the handler that the view has been closed:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">handler</span><span class="o">.</span><span class="n">closed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="p">)</span>

        <span class="c1"># Clear the back-link from the UIInfo object to us:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">ui</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Destroy the view control:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">_object</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">control</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Dispose of any KeyBindings object we reference:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_key_bindings</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_key_bindings</span><span class="o">.</span><span class="n">dispose</span><span class="p">()</span>

        <span class="c1"># Break the linkage to any objects in the context dictionary:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

        <span class="c1"># Remove specified symbols from our dictionary to aid in clean-up:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reset_traits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">recyclable_traits</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reset_traits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">disposable_traits</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">destroyed</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="UI.reset"><a class="viewcode-back" href="../../api/traitsui.ui.html#traitsui.ui.UI.reset">[docs]</a>    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">destroy</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Resets the contents of a user interface.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">editor</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_editors</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">editor</span><span class="o">.</span><span class="n">_ui</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1"># Propagate result to enclosed ui objects:</span>
                <span class="n">editor</span><span class="o">.</span><span class="n">_ui</span><span class="o">.</span><span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">result</span>
            <span class="n">editor</span><span class="o">.</span><span class="n">dispose</span><span class="p">()</span>

            <span class="c1"># Zap the control. If there are pending events for the control in</span>
            <span class="c1"># the UI queue, the editor&#39;s &#39;_update_editor&#39; method will see that</span>
            <span class="c1"># the control is None and discard the update request:</span>
            <span class="n">editor</span><span class="o">.</span><span class="n">control</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Remove any statusbar listeners that have been set up:</span>
        <span class="k">for</span> <span class="nb">object</span><span class="p">,</span> <span class="n">handler</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_statusbar</span><span class="p">:</span>
            <span class="nb">object</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">handler</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">remove</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dispatch</span><span class="o">=</span><span class="s2">&quot;ui&quot;</span><span class="p">)</span>

        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_statusbar</span><span class="p">[:]</span>

        <span class="k">if</span> <span class="n">destroy</span><span class="p">:</span>
            <span class="n">toolkit</span><span class="p">()</span><span class="o">.</span><span class="n">destroy_children</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">control</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">dispatcher</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dispatchers</span><span class="p">:</span>
            <span class="n">dispatcher</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span></div>

<div class="viewcode-block" id="UI.find"><a class="viewcode-back" href="../../api/traitsui.ui.html#traitsui.ui.UI.find">[docs]</a>    <span class="k">def</span> <span class="nf">find</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">include</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Finds the definition of the specified Include object in the current</span>
<span class="sd">        user interface building context.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span>
        <span class="n">result</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Get the context &#39;object&#39; (if available):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">context</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="nb">object</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">object</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;object&quot;</span><span class="p">)</span>

        <span class="c1"># Try to use our ViewElements objects:</span>
        <span class="n">ve</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_elements</span>

        <span class="c1"># If none specified, try to get it from the UI context:</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">ve</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">object</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
            <span class="c1"># Use the context object&#39;s ViewElements (if available):</span>
            <span class="n">ve</span> <span class="o">=</span> <span class="nb">object</span><span class="o">.</span><span class="n">trait_view_elements</span><span class="p">()</span>

        <span class="c1"># Ask the ViewElements to find the requested item for us:</span>
        <span class="k">if</span> <span class="n">ve</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">ve</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">include</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_search</span><span class="p">)</span>

        <span class="c1"># If not found, then try to search the &#39;handler&#39; and &#39;object&#39; for a</span>
        <span class="c1"># method we can call that will define it:</span>
        <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">handler</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;handler&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">handler</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">handler</span><span class="p">,</span> <span class="n">include</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">method</span><span class="p">):</span>
                    <span class="n">result</span> <span class="o">=</span> <span class="n">method</span><span class="p">()</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">result</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">object</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
                <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="nb">object</span><span class="p">,</span> <span class="n">include</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">method</span><span class="p">):</span>
                    <span class="n">result</span> <span class="o">=</span> <span class="n">method</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="UI.push_level"><a class="viewcode-back" href="../../api/traitsui.ui.html#traitsui.ui.UI.push_level">[docs]</a>    <span class="k">def</span> <span class="nf">push_level</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the current search stack level.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_search</span><span class="p">)</span></div>

<div class="viewcode-block" id="UI.pop_level"><a class="viewcode-back" href="../../api/traitsui.ui.html#traitsui.ui.UI.pop_level">[docs]</a>    <span class="k">def</span> <span class="nf">pop_level</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">level</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Restores a previously pushed search stack level.&quot;&quot;&quot;</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_search</span><span class="p">[:</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_search</span><span class="p">)</span> <span class="o">-</span> <span class="n">level</span><span class="p">]</span></div>

<div class="viewcode-block" id="UI.prepare_ui"><a class="viewcode-back" href="../../api/traitsui.ui.html#traitsui.ui.UI.prepare_ui">[docs]</a>    <span class="k">def</span> <span class="nf">prepare_ui</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Performs all processing that occurs after the user interface is</span>
<span class="sd">        created.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Invoke all of the editor &#39;name_defined&#39; methods we&#39;ve accumulated:</span>
        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">trait_set</span><span class="p">(</span><span class="n">initialized</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">method</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_defined</span><span class="p">:</span>
            <span class="n">method</span><span class="p">(</span><span class="n">info</span><span class="p">)</span>

        <span class="c1"># Then reset the list, since we don&#39;t need it anymore:</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_defined</span><span class="p">[:]</span>

        <span class="c1"># Synchronize all context traits with associated editor traits:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sync_view</span><span class="p">()</span>

        <span class="c1"># Hook all keyboard events:</span>
        <span class="n">toolkit</span><span class="p">()</span><span class="o">.</span><span class="n">hook_events</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">control</span><span class="p">,</span> <span class="s2">&quot;keys&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">key_handler</span><span class="p">)</span>

        <span class="c1"># Hook all events if the handler is an extended &#39;ViewHandler&#39;:</span>
        <span class="n">handler</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">handler</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">handler</span><span class="p">,</span> <span class="n">ViewHandler</span><span class="p">):</span>
            <span class="n">toolkit</span><span class="p">()</span><span class="o">.</span><span class="n">hook_events</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">control</span><span class="p">)</span>

        <span class="c1"># Invoke the handler&#39;s &#39;init&#39; method, and abort if it indicates</span>
        <span class="c1"># failure:</span>
        <span class="n">started</span> <span class="o">=</span> <span class="n">handler</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">info</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">started</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">TraitError</span><span class="p">(</span><span class="s2">&quot;User interface creation aborted&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">started</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Handler.init() must return True or False, but instead &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;returned </span><span class="si">{</span><span class="n">started</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="p">)</span>

        <span class="c1"># For each Handler method whose name is of the form</span>
        <span class="c1"># &#39;object_name_changed&#39;, where &#39;object&#39; is the name of an object in the</span>
        <span class="c1"># UI&#39;s &#39;context&#39;, create a trait notification handler that will call</span>
        <span class="c1"># the method whenever &#39;object&#39;s &#39;name&#39; trait changes. Also invoke the</span>
        <span class="c1"># method immediately so initial user interface state can be correctly</span>
        <span class="c1"># set:</span>
        <span class="n">context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_each_trait_method</span><span class="p">(</span><span class="n">handler</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">name</span><span class="p">[</span><span class="o">-</span><span class="mi">8</span><span class="p">:]</span> <span class="o">==</span> <span class="s2">&quot;_changed&quot;</span><span class="p">:</span>
                <span class="n">prefix</span> <span class="o">=</span> <span class="n">name</span><span class="p">[:</span><span class="o">-</span><span class="mi">8</span><span class="p">]</span>
                <span class="n">col</span> <span class="o">=</span> <span class="n">prefix</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">col</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="nb">object</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">prefix</span><span class="p">[:</span><span class="n">col</span><span class="p">])</span>
                    <span class="k">if</span> <span class="nb">object</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">handler</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
                        <span class="n">trait_name</span> <span class="o">=</span> <span class="n">prefix</span><span class="p">[</span><span class="n">col</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:]</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_dispatchers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                            <span class="n">Dispatcher</span><span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="nb">object</span><span class="p">,</span> <span class="n">trait_name</span><span class="p">)</span>
                        <span class="p">)</span>
                        <span class="k">if</span> <span class="nb">object</span><span class="o">.</span><span class="n">base_trait</span><span class="p">(</span><span class="n">trait_name</span><span class="p">)</span><span class="o">.</span><span class="n">type</span> <span class="o">!=</span> <span class="s2">&quot;event&quot;</span><span class="p">:</span>
                            <span class="n">method</span><span class="p">(</span><span class="n">info</span><span class="p">)</span>

        <span class="c1"># If there are any Editor object&#39;s whose &#39;visible&#39;, &#39;enabled&#39; or</span>
        <span class="c1"># &#39;checked&#39; state is controlled by a &#39;visible_when&#39;, &#39;enabled_when&#39; or</span>
        <span class="c1"># &#39;checked_when&#39; expression, set up an &#39;anytrait&#39; changed notification</span>
        <span class="c1"># handler on each object in the &#39;context&#39; that will cause the</span>
        <span class="c1"># &#39;visible&#39;, &#39;enabled&#39; or &#39;checked&#39; state of each affected Editor to be</span>
        <span class="c1">#  set. Also trigger the evaluation immediately, so the visible,</span>
        <span class="c1"># enabled or checked state of each Editor can be correctly initialized:</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_visible</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_enabled</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_checked</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">for</span> <span class="nb">object</span> <span class="ow">in</span> <span class="n">context</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                <span class="nb">object</span><span class="o">.</span><span class="n">on_trait_change</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_evaluate_when</span><span class="p">,</span> <span class="n">dispatch</span><span class="o">=</span><span class="s2">&quot;ui&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_do_evaluate_when</span><span class="p">(</span><span class="n">at_init</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Indicate that the user interface has been initialized:</span>
        <span class="n">info</span><span class="o">.</span><span class="n">initialized</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="UI.sync_view"><a class="viewcode-back" href="../../api/traitsui.ui.html#traitsui.ui.UI.sync_view">[docs]</a>    <span class="k">def</span> <span class="nf">sync_view</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Synchronize context object traits with view editor traits.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="nb">object</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sync_view</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">object</span><span class="p">,</span> <span class="s2">&quot;sync_to_view&quot;</span><span class="p">,</span> <span class="s2">&quot;from&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sync_view</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">object</span><span class="p">,</span> <span class="s2">&quot;sync_from_view&quot;</span><span class="p">,</span> <span class="s2">&quot;to&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sync_view</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">object</span><span class="p">,</span> <span class="s2">&quot;sync_with_view&quot;</span><span class="p">,</span> <span class="s2">&quot;both&quot;</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_sync_view</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="nb">object</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span> <span class="n">direction</span><span class="p">):</span>
        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span>
        <span class="k">for</span> <span class="n">trait_name</span><span class="p">,</span> <span class="n">trait</span> <span class="ow">in</span> <span class="nb">object</span><span class="o">.</span><span class="n">traits</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="n">metadata</span><span class="p">:</span> <span class="n">is_str</span><span class="p">})</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">sync</span> <span class="ow">in</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">trait</span><span class="p">,</span> <span class="n">metadata</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">editor_id</span><span class="p">,</span> <span class="n">editor_name</span> <span class="o">=</span> <span class="p">[</span>
                        <span class="n">item</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sync</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
                    <span class="p">]</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">TraitError</span><span class="p">(</span>
                        <span class="s2">&quot;The &#39;</span><span class="si">%s</span><span class="s2">&#39; metadata for the &#39;</span><span class="si">%s</span><span class="s2">&#39; trait in &quot;</span>
                        <span class="s2">&quot;the &#39;</span><span class="si">%s</span><span class="s2">&#39; context object should be of the form: &quot;</span>
                        <span class="s2">&quot;&#39;id1.trait1[,...,idn.traitn].&quot;</span>
                        <span class="o">%</span> <span class="p">(</span><span class="n">metadata</span><span class="p">,</span> <span class="n">trait_name</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
                    <span class="p">)</span>

                <span class="n">editor</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="n">editor_id</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">editor</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">editor</span><span class="o">.</span><span class="n">sync_value</span><span class="p">(</span>
                        <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">trait_name</span><span class="p">),</span> <span class="n">editor_name</span><span class="p">,</span> <span class="n">direction</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">TraitError</span><span class="p">(</span>
                        <span class="s2">&quot;No editor with id = &#39;</span><span class="si">%s</span><span class="s2">&#39; was found for &quot;</span>
                        <span class="s2">&quot;the &#39;</span><span class="si">%s</span><span class="s2">&#39; metadata for the &#39;</span><span class="si">%s</span><span class="s2">&#39; trait in the &#39;</span><span class="si">%s</span><span class="s2">&#39; &quot;</span>
                        <span class="s2">&quot;context object.&quot;</span>
                        <span class="o">%</span> <span class="p">(</span><span class="n">editor_id</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span> <span class="n">trait_name</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
                    <span class="p">)</span>

<div class="viewcode-block" id="UI.get_extended_value"><a class="viewcode-back" href="../../api/traitsui.ui.html#traitsui.ui.UI.get_extended_value">[docs]</a>    <span class="k">def</span> <span class="nf">get_extended_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gets the current value of a specified extended trait name.&quot;&quot;&quot;</span>
        <span class="n">names</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">names</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="p">[</span><span class="n">names</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
            <span class="k">del</span> <span class="n">names</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="p">[</span><span class="s2">&quot;object&quot;</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">value</span></div>

<div class="viewcode-block" id="UI.restore_prefs"><a class="viewcode-back" href="../../api/traitsui.ui.html#traitsui.ui.UI.restore_prefs">[docs]</a>    <span class="k">def</span> <span class="nf">restore_prefs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Retrieves and restores any saved user preference information</span>
<span class="sd">        associated with the UI.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span>
        <span class="k">if</span> <span class="nb">id</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">db</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ui_db</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">db</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">ui_prefs</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>
                    <span class="n">db</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_prefs</span><span class="p">(</span><span class="n">ui_prefs</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="k">pass</span>

        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="UI.set_prefs"><a class="viewcode-back" href="../../api/traitsui.ui.html#traitsui.ui.UI.set_prefs">[docs]</a>    <span class="k">def</span> <span class="nf">set_prefs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prefs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sets the values of user preferences for the UI.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">prefs</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span>
            <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_names</span><span class="p">:</span>
                <span class="n">editor</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">editor</span><span class="p">,</span> <span class="n">Editor</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">editor</span><span class="o">.</span><span class="n">ui</span> <span class="ow">is</span> <span class="bp">self</span><span class="p">):</span>
                    <span class="n">editor_prefs</span> <span class="o">=</span> <span class="n">prefs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">editor_prefs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">editor</span><span class="o">.</span><span class="n">restore_prefs</span><span class="p">(</span><span class="n">editor_prefs</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">key_bindings</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">key_bindings</span> <span class="o">=</span> <span class="n">prefs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;$&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">key_bindings</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">key_bindings</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">key_bindings</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">prefs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="UI.save_prefs"><a class="viewcode-back" href="../../api/traitsui.ui.html#traitsui.ui.UI.save_prefs">[docs]</a>    <span class="k">def</span> <span class="nf">save_prefs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prefs</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Saves any user preference information associated with the UI.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">prefs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">toolkit</span><span class="p">()</span><span class="o">.</span><span class="n">save_window</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="nb">id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span>
        <span class="k">if</span> <span class="nb">id</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">db</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ui_db</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s2">&quot;c&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">db</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">db</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_prefs</span><span class="p">(</span><span class="n">prefs</span><span class="p">)</span>
                <span class="n">db</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="UI.get_prefs"><a class="viewcode-back" href="../../api/traitsui.ui.html#traitsui.ui.UI.get_prefs">[docs]</a>    <span class="k">def</span> <span class="nf">get_prefs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prefs</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gets the preferences to be saved for the user interface.&quot;&quot;&quot;</span>
        <span class="n">ui_prefs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">prefs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ui_prefs</span><span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">prefs</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">key_bindings</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ui_prefs</span><span class="p">[</span><span class="s2">&quot;$&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">key_bindings</span>

        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_names</span><span class="p">:</span>
            <span class="n">editor</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">editor</span><span class="p">,</span> <span class="n">Editor</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">editor</span><span class="o">.</span><span class="n">ui</span> <span class="ow">is</span> <span class="bp">self</span><span class="p">):</span>
                <span class="n">prefs</span> <span class="o">=</span> <span class="n">editor</span><span class="o">.</span><span class="n">save_prefs</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">prefs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">ui_prefs</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">prefs</span>

        <span class="k">return</span> <span class="n">ui_prefs</span></div>

<div class="viewcode-block" id="UI.get_ui_db"><a class="viewcode-back" href="../../api/traitsui.ui.html#traitsui.ui.UI.get_ui_db">[docs]</a>    <span class="k">def</span> <span class="nf">get_ui_db</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns a reference to the Traits UI preference database.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">shelve</span><span class="o">.</span><span class="n">open</span><span class="p">(</span>
                <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">traits_home</span><span class="p">(),</span> <span class="s2">&quot;traits_ui&quot;</span><span class="p">),</span>
                <span class="n">flag</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span>
                <span class="n">protocol</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="UI.get_editors"><a class="viewcode-back" href="../../api/traitsui.ui.html#traitsui.ui.UI.get_editors">[docs]</a>    <span class="k">def</span> <span class="nf">get_editors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns a list of editors for the given trait name.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">editor</span> <span class="k">for</span> <span class="n">editor</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_editors</span> <span class="k">if</span> <span class="n">editor</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">name</span><span class="p">]</span></div>

<div class="viewcode-block" id="UI.get_error_controls"><a class="viewcode-back" href="../../api/traitsui.ui.html#traitsui.ui.UI.get_error_controls">[docs]</a>    <span class="k">def</span> <span class="nf">get_error_controls</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the list of editor error controls contained by the user</span>
<span class="sd">        interface.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">controls</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">editor</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_editors</span><span class="p">:</span>
            <span class="n">control</span> <span class="o">=</span> <span class="n">editor</span><span class="o">.</span><span class="n">get_error_control</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">control</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="n">controls</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">control</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">controls</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">control</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">controls</span></div>

<div class="viewcode-block" id="UI.add_defined"><a class="viewcode-back" href="../../api/traitsui.ui.html#traitsui.ui.UI.add_defined">[docs]</a>    <span class="k">def</span> <span class="nf">add_defined</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Adds a Handler method to the list of methods to be called once the</span>
<span class="sd">        user interface has been constructed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_defined</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">method</span><span class="p">)</span></div>

<div class="viewcode-block" id="UI.add_visible"><a class="viewcode-back" href="../../api/traitsui.ui.html#traitsui.ui.UI.add_visible">[docs]</a>    <span class="k">def</span> <span class="nf">add_visible</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">visible_when</span><span class="p">,</span> <span class="n">editor</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Adds a conditionally enabled Editor object to the list of monitored</span>
<span class="sd">        &#39;visible_when&#39; objects.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_visible</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="p">(</span><span class="nb">compile</span><span class="p">(</span><span class="n">visible_when</span><span class="p">,</span> <span class="s2">&quot;&lt;string&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;eval&quot;</span><span class="p">),</span> <span class="n">editor</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span></div>
            <span class="c1"># fixme: Log an error here...</span>

<div class="viewcode-block" id="UI.add_enabled"><a class="viewcode-back" href="../../api/traitsui.ui.html#traitsui.ui.UI.add_enabled">[docs]</a>    <span class="k">def</span> <span class="nf">add_enabled</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">enabled_when</span><span class="p">,</span> <span class="n">editor</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Adds a conditionally enabled Editor object to the list of monitored</span>
<span class="sd">        &#39;enabled_when&#39; objects.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_enabled</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="p">(</span><span class="nb">compile</span><span class="p">(</span><span class="n">enabled_when</span><span class="p">,</span> <span class="s2">&quot;&lt;string&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;eval&quot;</span><span class="p">),</span> <span class="n">editor</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span></div>
            <span class="c1"># fixme: Log an error here...</span>

<div class="viewcode-block" id="UI.add_checked"><a class="viewcode-back" href="../../api/traitsui.ui.html#traitsui.ui.UI.add_checked">[docs]</a>    <span class="k">def</span> <span class="nf">add_checked</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">checked_when</span><span class="p">,</span> <span class="n">editor</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Adds a conditionally enabled (menu) Editor object to the list of</span>
<span class="sd">        monitored &#39;checked_when&#39; objects.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_checked</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="p">(</span><span class="nb">compile</span><span class="p">(</span><span class="n">checked_when</span><span class="p">,</span> <span class="s2">&quot;&lt;string&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;eval&quot;</span><span class="p">),</span> <span class="n">editor</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span></div>
            <span class="c1"># fixme: Log an error here...</span>

<div class="viewcode-block" id="UI.do_undoable"><a class="viewcode-back" href="../../api/traitsui.ui.html#traitsui.ui.UI.do_undoable">[docs]</a>    <span class="k">def</span> <span class="nf">do_undoable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Performs an action that can be undone.&quot;&quot;&quot;</span>
        <span class="n">undoable</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_undoable</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">undoable</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">history</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_undoable</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">history</span><span class="o">.</span><span class="n">now</span>

            <span class="n">action</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">undoable</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_undoable</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span></div>

<div class="viewcode-block" id="UI.route_event"><a class="viewcode-back" href="../../api/traitsui.ui.html#traitsui.ui.UI.route_event">[docs]</a>    <span class="k">def</span> <span class="nf">route_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Routes a &quot;hooked&quot; event to the correct handler method.&quot;&quot;&quot;</span>
        <span class="n">toolkit</span><span class="p">()</span><span class="o">.</span><span class="n">route_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">)</span></div>

<div class="viewcode-block" id="UI.key_handler"><a class="viewcode-back" href="../../api/traitsui.ui.html#traitsui.ui.UI.key_handler">[docs]</a>    <span class="k">def</span> <span class="nf">key_handler</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="n">skip</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Handles key events.&quot;&quot;&quot;</span>
        <span class="n">key_bindings</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">key_bindings</span>
        <span class="n">handled</span> <span class="o">=</span> <span class="p">(</span><span class="n">key_bindings</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="n">key_bindings</span><span class="o">.</span><span class="n">do</span><span class="p">(</span>
            <span class="n">event</span><span class="p">,</span> <span class="p">[],</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">handled</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
            <span class="n">handled</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">key_handler</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">handled</span><span class="p">)</span> <span class="ow">and</span> <span class="n">skip</span><span class="p">:</span>
            <span class="n">toolkit</span><span class="p">()</span><span class="o">.</span><span class="n">skip_event</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">handled</span></div>

<div class="viewcode-block" id="UI.evaluate"><a class="viewcode-back" href="../../api/traitsui.ui.html#traitsui.ui.UI.evaluate">[docs]</a>    <span class="k">def</span> <span class="nf">evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">function</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kw_args</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Evaluates a specified function in the UI&#39;s **context**.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">function</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">function</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">function</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kw_args</span><span class="p">)</span>

        <span class="n">context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">context</span><span class="p">[</span><span class="s2">&quot;ui&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="n">context</span><span class="p">[</span><span class="s2">&quot;handler&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">handler</span>
        <span class="k">return</span> <span class="nb">eval</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <span class="nb">globals</span><span class="p">(),</span> <span class="n">context</span><span class="p">)(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kw_args</span><span class="p">)</span></div>

<div class="viewcode-block" id="UI.eval_when"><a class="viewcode-back" href="../../api/traitsui.ui.html#traitsui.ui.UI.eval_when">[docs]</a>    <span class="k">def</span> <span class="nf">eval_when</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">when</span><span class="p">,</span> <span class="n">result</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Evaluates an expression in the UI&#39;s **context** and returns the</span>
<span class="sd">        result.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_context</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">when</span><span class="p">,</span> <span class="nb">globals</span><span class="p">(),</span> <span class="n">context</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">traitsui.api</span> <span class="kn">import</span> <span class="n">raise_to_debug</span>

            <span class="n">raise_to_debug</span><span class="p">()</span>

        <span class="k">del</span> <span class="n">context</span><span class="p">[</span><span class="s2">&quot;ui&quot;</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">result</span></div>

    <span class="k">def</span> <span class="nf">_get_context</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gets the context to use for evaluating an expression.&quot;&quot;&quot;</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;object&quot;</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s2">&quot;handler&quot;</span> <span class="ow">in</span> <span class="n">context</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">context</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">name</span> <span class="o">!=</span> <span class="s2">&quot;handler&quot;</span><span class="p">:</span>
                    <span class="k">break</span>
        <span class="k">elif</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">value</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">context2</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">trait_get</span><span class="p">()</span>
            <span class="n">context2</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">context2</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="n">context2</span><span class="p">[</span><span class="s2">&quot;ui&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span>

        <span class="k">return</span> <span class="n">context2</span>

    <span class="k">def</span> <span class="nf">_evaluate_when</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the &#39;visible&#39;, &#39;enabled&#39;, and &#39;checked&#39; states for all Editors</span>
<span class="sd">        controlled by a &#39;visible_when&#39;, &#39;enabled_when&#39; or &#39;checked_when&#39;</span>
<span class="sd">        expression.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_do_evaluate_when</span><span class="p">(</span><span class="n">at_init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_do_evaluate_when</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">at_init</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the &#39;visible&#39;, &#39;enabled&#39;, and &#39;checked&#39; states for all Editors.</span>

<span class="sd">        This function does the job of _evaluate_when. We define it here to</span>
<span class="sd">        work around the traits dispatching mechanism that automatically</span>
<span class="sd">        determines the number of arguments of a notification method.</span>

<span class="sd">        :attr:`at_init` is set to true when this function is called the first</span>
<span class="sd">        time at initialization. In that case, we want to force the state of</span>
<span class="sd">        the items to be set (normally it is set only if it changes).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_evaluate_condition</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_visible</span><span class="p">,</span> <span class="s2">&quot;visible&quot;</span><span class="p">,</span> <span class="n">at_init</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_evaluate_condition</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_enabled</span><span class="p">,</span> <span class="s2">&quot;enabled&quot;</span><span class="p">,</span> <span class="n">at_init</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_evaluate_condition</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_checked</span><span class="p">,</span> <span class="s2">&quot;checked&quot;</span><span class="p">,</span> <span class="n">at_init</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_evaluate_condition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">conditions</span><span class="p">,</span> <span class="n">trait</span><span class="p">,</span> <span class="n">at_init</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Evaluates a list of (eval, editor) pairs and sets a specified trait</span>
<span class="sd">        on each editor to reflect the Boolean value of the expression.</span>

<span class="sd">        1) All conditions are evaluated</span>
<span class="sd">        2) The elements whose condition evaluates to False are updated</span>
<span class="sd">        3) The elements whose condition evaluates to True are updated</span>

<span class="sd">        E.g., we first make invisible all elements for which &#39;visible_when&#39;</span>
<span class="sd">        evaluates to False, and then we make visible the ones</span>
<span class="sd">        for which &#39;visible_when&#39; is True. This avoids mutually exclusive</span>
<span class="sd">        elements to be visible at the same time, and thus making a dialog</span>
<span class="sd">        unnecessarily large.</span>

<span class="sd">        The state of an editor is updated only when it changes, unless</span>
<span class="sd">        at_init is set to True.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        conditions : list of (str, Editor) tuple</span>
<span class="sd">            A list of tuples, each formed by 1) a string that contains a</span>
<span class="sd">            condition that evaluates to either True or False, and</span>
<span class="sd">            2) the editor whose state depends on the condition</span>

<span class="sd">        trait : str</span>
<span class="sd">            The trait that is set by the condition.</span>
<span class="sd">            Either &#39;visible, &#39;enabled&#39;, or &#39;checked&#39;.</span>

<span class="sd">        at_init : bool</span>
<span class="sd">            If False, the state of an editor is set only when it changes</span>
<span class="sd">            (e.g., a visible element would not be updated to visible=True</span>
<span class="sd">            again). If True, the state is always updated (used at</span>
<span class="sd">            initialization).</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_context</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="p">)</span>

        <span class="c1"># list of elements that should be activated</span>
        <span class="n">activate</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># list of elements that should be de-activated</span>
        <span class="n">deactivate</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">when</span><span class="p">,</span> <span class="n">editor</span> <span class="ow">in</span> <span class="n">conditions</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">cond_value</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">when</span><span class="p">,</span> <span class="nb">globals</span><span class="p">(),</span> <span class="n">context</span><span class="p">)</span>
                <span class="n">editor_state</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">editor</span><span class="p">,</span> <span class="n">trait</span><span class="p">)</span>

                <span class="c1"># add to update lists only if at_init is True (called on</span>
                <span class="c1"># initialization), or if the editor state has to change</span>

                <span class="k">if</span> <span class="n">cond_value</span> <span class="ow">and</span> <span class="p">(</span><span class="n">at_init</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">editor_state</span><span class="p">):</span>
                    <span class="n">activate</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">editor</span><span class="p">)</span>

                <span class="k">if</span> <span class="ow">not</span> <span class="n">cond_value</span> <span class="ow">and</span> <span class="p">(</span><span class="n">at_init</span> <span class="ow">or</span> <span class="n">editor_state</span><span class="p">):</span>
                    <span class="n">deactivate</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">editor</span><span class="p">)</span>

            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="c1"># catch errors in the validate_when expression</span>
                <span class="kn">from</span> <span class="nn">traitsui.api</span> <span class="kn">import</span> <span class="n">raise_to_debug</span>

                <span class="n">raise_to_debug</span><span class="p">()</span>

        <span class="c1"># update the state of the editors</span>
        <span class="k">for</span> <span class="n">editor</span> <span class="ow">in</span> <span class="n">deactivate</span><span class="p">:</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">editor</span><span class="p">,</span> <span class="n">trait</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">editor</span> <span class="ow">in</span> <span class="n">activate</span><span class="p">:</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">editor</span><span class="p">,</span> <span class="n">trait</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get__groups</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the top-level Groups for the view (after resolving</span>
<span class="sd">        Includes. (Implements the **_groups** property.)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_groups_cache</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">shadow_group</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">get_shadow</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_groups_cache</span> <span class="o">=</span> <span class="n">shadow_group</span><span class="o">.</span><span class="n">get_content</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_groups_cache</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">Item</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_groups_cache</span> <span class="o">=</span> <span class="p">[</span>
                        <span class="n">ShadowGroup</span><span class="p">(</span>
                            <span class="n">shadow</span><span class="o">=</span><span class="n">Group</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_groups_cache</span><span class="p">),</span>
                            <span class="n">content</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_groups_cache</span><span class="p">,</span>
                            <span class="n">groups</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                        <span class="p">)</span>
                    <span class="p">]</span>
                    <span class="k">break</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_groups_cache</span>

    <span class="c1"># -- Property Implementations ---------------------------------------------</span>

    <span class="k">def</span> <span class="nf">_get_key_bindings</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_key_bindings</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># create a new key_bindings instance lazily</span>

            <span class="n">view</span><span class="p">,</span> <span class="n">context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">view</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">context</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
                <span class="k">return</span> <span class="kc">None</span>

            <span class="c1"># Get the KeyBindings object to use:</span>
            <span class="n">values</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
            <span class="n">key_bindings</span> <span class="o">=</span> <span class="n">view</span><span class="o">.</span><span class="n">key_bindings</span>
            <span class="k">if</span> <span class="n">key_bindings</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="kn">from</span> <span class="nn">.key_bindings</span> <span class="kn">import</span> <span class="n">KeyBindings</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">_key_bindings</span> <span class="o">=</span> <span class="n">KeyBindings</span><span class="p">(</span><span class="n">controllers</span><span class="o">=</span><span class="n">values</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_key_bindings</span> <span class="o">=</span> <span class="n">key_bindings</span><span class="o">.</span><span class="n">clone</span><span class="p">(</span><span class="n">controllers</span><span class="o">=</span><span class="n">values</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_key_bindings</span>

    <span class="c1"># -- Traits Event Handlers ------------------------------------------------</span>

    <span class="k">def</span> <span class="nf">_errors_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">old</span><span class="p">,</span> <span class="n">new</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">errors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">errors</span> <span class="o">-</span> <span class="n">old</span> <span class="o">+</span> <span class="n">new</span>

    <span class="k">def</span> <span class="nf">_parent_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">old</span><span class="p">,</span> <span class="n">new</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">old</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">old</span><span class="o">.</span><span class="n">errors</span> <span class="o">-=</span> <span class="bp">self</span><span class="o">.</span><span class="n">errors</span>
        <span class="k">if</span> <span class="n">new</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">new</span><span class="o">.</span><span class="n">errors</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">errors</span>

    <span class="k">def</span> <span class="nf">_updated_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rebuild</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">toolkit</span><span class="p">()</span><span class="o">.</span><span class="n">rebuild_ui</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_title_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">control</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">toolkit</span><span class="p">()</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_icon_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">control</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">toolkit</span><span class="p">()</span><span class="o">.</span><span class="n">set_icon</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="nd">@observe</span><span class="p">(</span><span class="s2">&quot;parent, view, context&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_pvc_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">parent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key_bindings</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
            <span class="c1"># If we don&#39;t have our own history, use our parent&#39;s:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">history</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">history</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">history</span>

            <span class="c1"># Link our KeyBindings object as a child of our parent&#39;s</span>
            <span class="c1"># KeyBindings object (if any):</span>
            <span class="k">if</span> <span class="n">parent</span><span class="o">.</span><span class="n">key_bindings</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">parent</span><span class="o">.</span><span class="n">key_bindings</span><span class="o">.</span><span class="n">children</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key_bindings</span><span class="p">)</span></div>


<div class="viewcode-block" id="Dispatcher"><a class="viewcode-back" href="../../api/traitsui.ui.html#traitsui.ui.Dispatcher">[docs]</a><span class="k">class</span> <span class="nc">Dispatcher</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="nb">object</span><span class="p">,</span> <span class="n">method_name</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initializes the object.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">=</span> <span class="n">method</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">info</span> <span class="o">=</span> <span class="n">info</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">object</span> <span class="o">=</span> <span class="nb">object</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">method_name</span> <span class="o">=</span> <span class="n">method_name</span>
        <span class="nb">object</span><span class="o">.</span><span class="n">on_trait_change</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dispatch</span><span class="p">,</span> <span class="n">method_name</span><span class="p">,</span> <span class="n">dispatch</span><span class="o">=</span><span class="s2">&quot;ui&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="Dispatcher.dispatch"><a class="viewcode-back" href="../../api/traitsui.ui.html#traitsui.ui.Dispatcher.dispatch">[docs]</a>    <span class="k">def</span> <span class="nf">dispatch</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Dispatches the method.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">method</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">)</span></div>

<div class="viewcode-block" id="Dispatcher.remove"><a class="viewcode-back" href="../../api/traitsui.ui.html#traitsui.ui.Dispatcher.remove">[docs]</a>    <span class="k">def</span> <span class="nf">remove</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Removes the dispatcher.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">on_trait_change</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dispatch</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">method_name</span><span class="p">,</span> <span class="n">remove</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span></div></div>
</pre></div>

          </div>
        </div>
          </div>
      <div class="spc-rightsidebar span3">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/img/e-logo.png" alt="Logo">
            </a></p>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
        </div>
      </div>
    </div>

    <div class="container container-navbar-bottom">
      <div class="spc-navbar">
        
      </div>
    </div>
    <div class="container">
    <div class="footer">
    <div class="row-fluid">
    <ul class="inline pull-left">
      <li>
        &copy; Copyright 2008-2023, Enthought
      </li>
      <li>
      Last updated on May 22, 2023.
      </li>
      <li>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 7.0.1.
      </li>
    </ul>
    </div>
    </div>
    </div>
  </body>
</html>