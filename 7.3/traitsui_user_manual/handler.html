
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8">
    
    <title>Controlling the Interface: the Handler &mdash; TraitsUI 7 Documentation</title>
    
    <link rel="stylesheet" type="text/css" href="../_static/css/spc-bootstrap.css">
    <link rel="stylesheet" type="text/css" href="../_static/css/spc-extend.css">
    <link rel="stylesheet" href="../_static/enthought.css" type="text/css" >
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" >
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        LINK_SUFFIX: '.html',
        SOURCELINK_SUFFIX: '.txt',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/js/copybutton.js"></script>
    <script type="text/javascript" src="../_static/js/wrap_on_dot.js"></script>
    <link rel="shortcut icon" href="../_static/img/favicon.png">
    <link rel="index" title="Index" href="../genindex.html" >
    <link rel="search" title="Search" href="../search.html" >
    <link rel="top" title="TraitsUI 7 Documentation" href="../index.html" >
    <link rel="up" title="TraitsUI 7.3.1 User Manual" href="index.html" >
    <link rel="next" title="Introduction to Trait Editor Factories" href="factory_intro.html" >
    <link rel="prev" title="Advanced View Concepts" href="advanced_view.html" > 
  </head>
  <body>
  <div class="container">
    <div class="header">
    </div>
  </div>

    <div class="container">
      <div class="main">
        
	<div class="row-fluid">
	  <div class="span12">
	    <div class="spc-navbar">
              
    <ul class="nav nav-pills pull-left">
	
        <li class="active"><a href="../index.html">TraitsUI 7 Documentation</a></li>
	
          <li class="active"><a href="index.html" accesskey="U">TraitsUI 7.3.1 User Manual</a></li>
  
    <li><a href="#">Controlling the Interface: the Handler</a></li>
  

    </ul>
              
              
    <ul class="nav nav-pills pull-right">
      <li class="active">
        <a href="../genindex.html" title="General Index"
           accesskey="I">index</a>
      </li>
      <li class="active">
        <a href="../py-modindex.html" title="Python Module Index"
           >modules</a>
      </li>
      <li class="active">
        <a href="factory_intro.html" title="Introduction to Trait Editor Factories"
           accesskey="N">next</a>
      </li>
      <li class="active">
        <a href="advanced_view.html" title="Advanced View Concepts"
           accesskey="P">previous</a>
      </li>
    </ul>
              
	    </div>
	  </div>
	</div>
        

	<div class="row-fluid">
          <div class="span9">
            
        <div class="bodywrapper">
          <div class="body" id="spc-section-body" role="main">
            
  <div class="section" id="controlling-the-interface-the-handler">
<span id="id1"></span><h1>Controlling the Interface: the Handler<a class="headerlink" href="#controlling-the-interface-the-handler" title="Permalink to this headline">¶</a></h1>
<p>Most of the material in the preceding chapters is concerned with the
relationship between the model and view aspects of the <a class="reference internal" href="glossary.html#term-MVC"><span class="xref std std-term">MVC</span></a> design
pattern as supported by TraitsUI. This chapter examines the third aspect: the
<a class="reference internal" href="glossary.html#term-controller"><span class="xref std std-term">controller</span></a>, implemented in TraitsUI as an <a class="reference internal" href="glossary.html#term-instance"><span class="xref std std-term">instance</span></a> of the
<a class="reference internal" href="glossary.html#term-Handler"><span class="xref std std-term">Handler</span></a> class. <a class="footnote-reference brackets" href="#id20" id="id2">11</a></p>
<p>A controller for an MVC-based application is essentially an event handler for
GUI events, i.e., for events that are generated through or by the program
interface. Such events can require changes to one or more model objects (e.g.,
because a data value has been updated) or manipulation of the interface itself
(e.g., window closure, dynamic interface behavior). In TraitsUI, such actions
are performed by a Handler object.</p>
<p>In the preceding examples in this guide, the Handler object has been implicit:
TraitsUI provides a default Handler that takes care of a common set of GUI
events including window initialization and closure, data value updates, and
button press events for the standard TraitsUI window buttons (see
<a class="reference internal" href="custom_view.html#command-buttons-the-buttons-attribute"><span class="std std-ref">Command Buttons: the buttons Attribute</span></a>).</p>
<p>This chapter explains the features of the TraitsUI Handler, and shows how to
implement custom GUI behaviors by building and instantiating custom subclasses
of the Handler class. The final section of the chapter describes several
techniques for linking a custom Handler to the window or windows it is designed
to control.</p>
<div class="section" id="backstage-introducing-the-uiinfo-object">
<span id="id3"></span><h2>Backstage: Introducing the UIInfo Object<a class="headerlink" href="#backstage-introducing-the-uiinfo-object" title="Permalink to this headline">¶</a></h2>
<p>TraitsUI supports the MVC design pattern by maintaining the model, view, and
controller as separate entities. A single View object can be used to construct
windows for multiple model objects; likewise a single Handler can handle GUI
events for windows created using different Views. Thus there is no static link
between a Handler and any particular window or model object. However, in order
to be useful, a Handler must be able to observe and manipulate both its
corresponding window and model objects. In TraitsUI, this is accomplished by
means of the UIInfo object.</p>
<p>Whenever TraitsUI creates a window or panel from a View, a UIInfo object is
created to act as the Handler’s reference to that window and to the objects
whose <a class="reference internal" href="glossary.html#term-trait-attribute"><span class="xref std std-term">trait attribute</span></a>s are displayed in it.  This object holds a
reference to the UI instance in its <strong>ui</strong> trait, and whether or not
the UI has been initialized in the <strong>initialized</strong> trait.  Additionally,
this object is dynamically assigned trait attributes which correspond to:</p>
<ul class="simple">
<li><p>each entry in the View’s context (see <a class="reference internal" href="advanced_view.html#the-view-context"><span class="std std-ref">The View Context</span></a>).</p></li>
<li><p>each item’s and group’s editor in the view, by id (or name, if no id is
available for an item).</p></li>
</ul>
<p>Where there is conflict between ids, the editors take precedence over context
values, and if two editors have the same name then the last editor with that
name will be referenced.</p>
<p>For example, the UIInfo object created in <a class="reference internal" href="advanced_view.html#example-7-using-a-multi-object-view-with-a-context"><span class="std std-ref">Example 7</span></a>
has attributes <strong>h1</strong> and <strong>h2</strong> whose values are the objects <strong>house1</strong> and
<strong>house2</strong> respectively.  Additionally it has attributes <strong>address</strong>,
<strong>bedroom</strong>, <strong>pool</strong>, and <strong>price</strong> that reference the editors in the second
group.</p>
<p>In <a class="reference internal" href="view.html#example-1-using-configure-traits"><span class="std std-ref">Example 1</span></a>
through <a class="reference internal" href="advanced_view.html#example-6-defining-multiple-view-objects-in-a-hastraits-class"><span class="std std-ref">Example 6</span></a>,
the created UIInfo object has an attribute <strong>object</strong> whose value is the object
<strong>sam</strong>, together with attributes that corrspond to the items in the views,
such as <strong>first_name</strong>, <strong>last_name</strong> and <strong>department</strong>.</p>
<p>Whenever a window event causes a Handler method to be called, TraitsUI passes
the corresponding UIInfo object as one of the method arguments. This gives the
Handler the information necessary to perform its tasks.</p>
<p>Additionally, traits on objects in the context can be synchronized with traits
on editors via the <strong>sync_to_view</strong>, <strong>sync_from_view</strong> and <strong>sync_with_view</strong>
trait metadata.  Note that not every trait on every editor can react to changes:
some values are only used at editor creation time; however all editors support
dynamically changing the <strong>enabled</strong>, <strong>visible</strong> and <strong>invalid</strong> traits.  This
feature can sometimes allow developers to avoid having to create a custom Handler
subclass.</p>
<p>See the <a class="reference external" href="https://github.com/enthought/traitsui/tree/7.3.1/traitsui/examples/demo/Advanced/Invalid_state_handling.py">Invalid state handling</a>
example which demonstrates how to use this mechanism to control the invalid state
of a dialog based on the value of multiple editors.</p>
</div>
<div class="section" id="backstage-the-ui-object">
<span id="id4"></span><h2>Backstage: The UI Object<a class="headerlink" href="#backstage-the-ui-object" title="Permalink to this headline">¶</a></h2>
<p>As opposed to the very dynamic UIInfo object, the UI class provides an object
which ties together the various objects that are involved in a TraitsUI GUI:
the View, the context, the Handler, the underlying toolkit controls and the
shared state of the GUI.  It also has some life-cycle and useful utility methods
that can be useful when working from a handler.</p>
<p>The UI object is returned as the result of a call to edit_traits(), and as noted
in the previous section, is available as the <strong>ui</strong> attribute of the UIInfo object
that is passed to most handler methods.</p>
<p class="rubric">Attributes of UI, by category</p>
<dl class="simple">
<dt>TraitsUI core</dt><dd><dl class="simple">
<dt>view:</dt><dd><p>View template used to construct the user interface.</p>
</dd>
<dt>handler:</dt><dd><p>Handler object used for event handling.</p>
</dd>
<dt>context:</dt><dd><p>Dictionary of objects that the UI is editing.</p>
</dd>
<dt>info:</dt><dd><p>UIInfo object containing context or editor objects</p>
</dd>
<dt>parent:</dt><dd><p>The parent UI (if any) of this UI.</p>
</dd>
</dl>
</dd>
<dt>Toolkit</dt><dd><dl class="simple">
<dt>control:</dt><dd><p>Panel or dialog associated with the user interface.</p>
</dd>
<dt>owner:</dt><dd><p>Toolkit-specific object that “owns” <strong>control</strong></p>
</dd>
</dl>
</dd>
<dt>GUI state</dt><dd><dl class="simple">
<dt>id:</dt><dd><p>The unique ID for this UI for persistence.</p>
</dd>
<dt>title:</dt><dd><p>Title of the dialog, if any.</p>
</dd>
<dt>icon:</dt><dd><p>The ImageResource of the dialog icon, if any.</p>
</dd>
<dt>key_bindings:</dt><dd><p>The KeyBindings object (if any) for this UI.</p>
</dd>
<dt>result:</dt><dd><p>Result from a modal or wizard dialog.</p>
</dd>
<dt>modified:</dt><dd><p>Have any modifications been made to UI contents?</p>
</dd>
<dt>updated:</dt><dd><p>Event when the user interface has changed.</p>
</dd>
<dt>history:</dt><dd><p>Undo and Redo history.</p>
</dd>
<dt>errors:</dt><dd><p>The number of currently pending editor error conditions.
Note that changing this must be done very carefully to avoid
permanent error states.</p>
</dd>
<dt>destroyed:</dt><dd><p>Set to True when the UI has finished being destroyed.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Useful UI methods</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 35%" />
<col style="width: 65%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Method</p></th>
<th class="head"><p>Purpose</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>dispose(result, abort)</p></td>
<td><p>Disposes of the UI.  This can be called to close a
TraitsUI dialog programatically from a handler.</p></td>
</tr>
<tr class="row-odd"><td><p>get_editors(name)</p></td>
<td><p>Returns a list of all editors matching the name.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="assigning-handlers-to-views">
<span id="id5"></span><h2>Assigning Handlers to Views<a class="headerlink" href="#assigning-handlers-to-views" title="Permalink to this headline">¶</a></h2>
<p>In accordance with the MVC design pattern, Handlers and Views are separate
entities belonging to distinct classes. In order for a custom Handler to provide
the control logic for a window, it must be explicitly associated with the View
for that window. The TraitsUI package provides three ways to accomplish this:</p>
<ul class="simple">
<li><p>Make the Handler an attribute of the View.</p></li>
<li><p>Provide the Handler as an argument to a display method such as edit_traits().</p></li>
<li><p>Define the View as part of the Handler.</p></li>
</ul>
<div class="section" id="binding-a-singleton-handler-to-a-view">
<span id="id6"></span><h3>Binding a Singleton Handler to a View<a class="headerlink" href="#binding-a-singleton-handler-to-a-view" title="Permalink to this headline">¶</a></h3>
<p>To associate a given custom Handler with all windows produced from a given View,
assign an instance of the custom Handler class to the View’s <strong>handler</strong>
attribute. The result of this technique, as shown in
<a class="reference internal" href="#example-9-using-a-handler-that-reacts-to-trait-changes"><span class="std std-ref">Example 9</span></a>, is
that the window created by the View object is automatically controlled by the
specified handler instance.</p>
</div>
<div class="section" id="linking-handler-and-view-at-edit-time">
<span id="id7"></span><h3>Linking Handler and View at Edit Time<a class="headerlink" href="#linking-handler-and-view-at-edit-time" title="Permalink to this headline">¶</a></h3>
<p>It is also possible to associate a custom Handler with a specific window without
assigning it permanently to the View. Each of the three TraitsUI
window-building methods (the configure_traits() and edit_traits() methods of the
HasTraits class and the ui() method of the View class) has a <em>handler</em> keyword
argument. Assigning an instance of Handler to this argument gives that handler
instance control <em>only of the specific window being created by the method call</em>.
This assignment overrides the View’s <strong>handler</strong> attribute.</p>
</div>
<div class="section" id="creating-a-default-view-within-a-handler">
<span id="id8"></span><h3>Creating a Default View Within a Handler<a class="headerlink" href="#creating-a-default-view-within-a-handler" title="Permalink to this headline">¶</a></h3>
<p>You seldom need to associate a single custom Handler with several different
Views or vice versa, although you can in theory and there are cases where it is
useful to be able to do so. In most real-life scenarios, a custom Handler is
tailored to a particular View with which it is always used. One way to reflect
this usage in the program design is to define the View as part of the Handler.
The same rules apply as for defining Views within HasTraits objects; for
example, a view named ‘trait_view’ is used as the default view.</p>
<p>The Handler class, which is a subclass of HasTraits, overrides the standard
configure_traits() and edit_traits() methods; the subclass versions are
identical to the originals except that the Handler object on which they are
called becomes the default Handler for the resulting windows. Note that for
these versions of the display methods, the <em>context</em> keyword parameter is not
optional.</p>
</div>
</div>
<div class="section" id="handler-subclasses">
<span id="id9"></span><h2>Handler Subclasses<a class="headerlink" href="#handler-subclasses" title="Permalink to this headline">¶</a></h2>
<p>TraitsUI provides two Handler subclasses: ModelView and Controller.  Both of
these classes are designed to simplify the process of creating an MVC-based
application.</p>
<p>Both ModelView and Controller extend the Handler class by adding the following
trait attributes:</p>
<ul class="simple">
<li><p><strong>model</strong>: The model object for which this handler defines a view and
controller.</p></li>
<li><p><strong>info</strong>: The UIInfo object associated with the actual user interface window
or panel for the model object.</p></li>
</ul>
<p>The <strong>model</strong> attribute provides convenient access to the model object
associated with either subclass. Normally, the <strong>model</strong> attribute is set in the
constructor when an instance of ModelView or Controller is created.</p>
<p>The <strong>info</strong> attribute provides convenient access to the UIInfo object
associated with the active user interface view for the handler object. The
<strong>info</strong> attribute is automatically set when the handler object’s view is
created.</p>
<p>Both classes’ constructors accept an optional <em>model</em> parameter, which is the
model object. They also can accept metadata as keyword parameters.</p>
<dl class="py class">
<dt id="ModelView">
<em class="property"><span class="pre">class</span> </em><code class="sig-name descname"><span class="pre">ModelView</span></code><span class="sig-paren">(</span><span class="optional">[</span><em class="sig-param"><span class="pre">model</span> <span class="pre">=</span> <span class="pre">None</span></em>, <em class="sig-param"><span class="pre">**metadata</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#ModelView" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py class">
<dt id="Controller">
<em class="property"><span class="pre">class</span> </em><code class="sig-name descname"><span class="pre">Controller</span></code><span class="sig-paren">(</span><span class="optional">[</span><em class="sig-param"><span class="pre">model</span> <span class="pre">=</span> <span class="pre">None</span></em>, <em class="sig-param"><span class="pre">**metadata</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#Controller" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>The difference between the ModelView and Controller classes lies in the context
dictionary that each one passes to its associated user interface, as described
in the following sections.</p>
<div class="section" id="controller-class">
<span id="id10"></span><h3>Controller Class<a class="headerlink" href="#controller-class" title="Permalink to this headline">¶</a></h3>
<p>The Controller class is normally used when implementing a standard MVC-based
design, and plays the “controller” role in the MVC design pattern. The “model”
role is played by the object referenced by the Controller’s <strong>model</strong> attribute;
and the “view” role is played by the View object associated with the model
object.</p>
<p>The context dictionary that a Controller object passes to the View’s ui() method
contains the following entries:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">object</span></code>: The Controller’s model object.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">controller</span></code>: The Controller object itself.</p></li>
</ul>
<p>Using a Controller as the handler class assumes that the model object contains
most, if not all, of the data to be viewed. Therefore, the model object is used
for the object key in the context dictionary, so that its attributes can be
easily referenced with unqualified names (such as Item(‘name’)).</p>
</div>
<div class="section" id="modelview-class">
<span id="id11"></span><h3>ModelView Class<a class="headerlink" href="#modelview-class" title="Permalink to this headline">¶</a></h3>
<p>The ModelView class is useful when creating a variant of the standard MVC
design pattern. In this variant, the ModelView subclass reformulates a number
of trait attributes on its model object as properties on the ModelView, usually
to convert the model’s data into a format that is more suited to a user
interface.</p>
<p>The context dictionary that a ModelView object passes to the View’s ui() method
contains the following entries:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">object</span></code>: The ModelView object itself.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">model</span></code>: The ModelView’s model object.</p></li>
</ul>
<p>In effect, the ModelView object substitutes itself for the model object in
relation to the View object, serving both the “controller” role and the “model”
role (as a set of properties wrapped around the original model). Because the
ModelView object is passed as the context’s object, its attributes can be
referenced by unqualified names in the View definition.</p>
</div>
</div>
<div class="section" id="writing-handler-methods">
<span id="id12"></span><h2>Writing Handler Methods<a class="headerlink" href="#writing-handler-methods" title="Permalink to this headline">¶</a></h2>
<p>If you create a custom Handler subclass, depending on the behavior you want to
implement, you might override the standard methods of Handler, or you might
create methods that respond to changes to specific trait attributes.</p>
<div class="section" id="overriding-standard-methods">
<span id="id13"></span><h3>Overriding Standard Methods<a class="headerlink" href="#overriding-standard-methods" title="Permalink to this headline">¶</a></h3>
<p>The Handler class provides methods that are automatically executed at certain
points in the lifespan of the window controlled by a given Handler. By
overriding these methods, you can implement a variety of custom window
behaviors. The following sequence shows the points at which the Handler methods
are called.</p>
<ol class="arabic simple">
<li><p>A UIInfo object is created</p></li>
<li><p>The Handler’s init_info() method is called. Override this method if the
handler needs access to viewable traits on the UIInfo object whose values
are properties that depend on items in the context being edited.</p></li>
<li><p>The UI object is created, and generates the actual window.</p></li>
<li><p>The init() method is called. Override this method if you need to initialize
or customize the window.</p></li>
</ol>
<ol class="arabic simple" start="5">
<li><p>The position() method is called. Override this method to modify the position
of the window (if setting the x and y attributes of the View is insufficient).</p></li>
<li><p>The window is displayed.</p></li>
</ol>
<p class="rubric" id="when-handler-methods-are-called-and-when-to-override-them-table">When Handler methods are called, and when to override them</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 36%" />
<col style="width: 34%" />
<col style="width: 30%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Method</p></th>
<th class="head"><p>Called When</p></th>
<th class="head"><p>Override When?</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>apply(info)</p></td>
<td><p>The user clicks the
<span class="guilabel">Apply</span> button,
and after the changes have
been applied to the
context objects.</p></td>
<td><p>To perform additional
processing at this
point.</p></td>
</tr>
<tr class="row-odd"><td><p>close(info, is_ok)</p></td>
<td><p>The user requests to close
the window, clicking
<span class="guilabel">OK</span>,
<span class="guilabel">Cancel</span>, or the
window close button, menu,
or icon.</p></td>
<td><p>To perform additional
checks before
destroying the window.</p></td>
</tr>
<tr class="row-even"><td><p>closed(info, is_ok)</p></td>
<td><p>The window has been
destroyed.</p></td>
<td><p>To perform additional
clean-up tasks.</p></td>
</tr>
<tr class="row-odd"><td><p>revert(info)</p></td>
<td><p>The user clicks the
<span class="guilabel">Revert</span> button,
or clicks
<span class="guilabel">Cancel</span> in a
live window.</p></td>
<td><p>To perform additional
processing.</p></td>
</tr>
<tr class="row-even"><td><p>setattr(info, object, name,
value)</p></td>
<td><p>The user changes a trait
attribute value through
the user interface.</p></td>
<td><p>To perform additional
processing, such as
keeping a change
history. Make sure that
the overriding method
actually sets the
attribute.</p></td>
</tr>
<tr class="row-odd"><td><p>show_help(info,
control=None)</p></td>
<td><p>The user clicks the
<span class="guilabel">Help</span> button.</p></td>
<td><p>To call a custom help
handler in addition to
or instead of the
global help handler,
for this window.</p></td>
</tr>
<tr class="row-even"><td><p>perform(info, action,
event)</p></td>
<td><p>The user clicks a button
or toolbar item, or
selects a menu item.</p></td>
<td><p>To change the way that
actions are handled,
eg. to pass more info
to a method.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="reacting-to-trait-changes">
<span id="id14"></span><h3>Reacting to Trait Changes<a class="headerlink" href="#reacting-to-trait-changes" title="Permalink to this headline">¶</a></h3>
<p>The setattr() method described above is called whenever any trait value is
changed in the UI. However, TraitsUI also provides a mechanism for calling
methods that are automatically executed whenever the user edits a <em>particular</em>
trait. While you can use static notification handler methods on the HasTraits
object, you might want to implement behavior that concerns only the user
interface. In that case, following the MVC pattern dictates that such behavior
should not be implemented in the “model” part of the code. In keeping with this
pattern, TraitsUI supports “user interface notification” methods, which must
have a signature with the following format:</p>
<dl class="py method">
<dt id="extended_traitname_changed">
<code class="sig-name descname"><span class="pre">extended_traitname_changed</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">info</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#extended_traitname_changed" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>This method is called whenever a change is made to the attribute specified by
<em>extended_traitname</em> in the <strong>context</strong> of the View used to create the window
(see <a class="reference internal" href="advanced_view.html#multi-object-views"><span class="std std-ref">Multi-Object Views</span></a>), where the dots in the extended trait reference
have been replaced by underscores. For example, for a method to handle changes
on the <strong>salary</strong> attribute of the object whose context key is ‘object’ (the
default object), the method name should be object_salary_changed().</p>
<p>By contrast, a subclass of Handler for
<a class="reference internal" href="advanced_view.html#example-7-using-a-multi-object-view-with-a-context"><span class="std std-ref">Example 7</span></a> might
include a method called h2_price_changed() to be called whenever the price of
the second house is edited.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>These methods are called on window creation.</p>
<p>User interface notification methods are called when the window is first
created.</p>
</div>
<p>To differentiate between code that should be executed when the window is first
initialized and code that should be executed when the trait actually changes,
use the <strong>initialized</strong> attribute of the UIInfo object (i.e., of the <em>info</em>
argument):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">object_foo_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">info</span><span class="p">):</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">info</span><span class="o">.</span><span class="n">initialized</span><span class="p">:</span>
        <span class="c1">#code to be executed only when the window is</span>
        <span class="c1">#created</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1">#code to be executed only when &#39;foo&#39; changes after</span>
        <span class="c1">#window initialization</span>

    <span class="c1">#code to be executed in either case</span>
</pre></div>
</div>
<p>The following script, which annotates its window’s title with an asterisk (‘*’)
the first time a data element is updated, demonstrates a simple use of both an
overridden setattr() method and user interface notification method.</p>
<p class="rubric" id="example-9-using-a-handler-that-reacts-to-trait-changes">Example 9: Using a Handler that reacts to trait changes</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># handler_override.py -- Example of a Handler that overrides setattr(), and</span>
<span class="c1"># that has a user interface notification method</span>

<span class="kn">from</span> <span class="nn">traits.api</span> <span class="kn">import</span> <span class="n">Bool</span><span class="p">,</span> <span class="n">HasTraits</span>
<span class="kn">from</span> <span class="nn">traitsui.api</span> <span class="kn">import</span> <span class="n">Handler</span><span class="p">,</span> <span class="n">View</span>


<span class="k">class</span> <span class="nc">TC_Handler</span><span class="p">(</span><span class="n">Handler</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="nb">object</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="n">Handler</span><span class="o">.</span><span class="n">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="nb">object</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="n">info</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">_updated</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">object__updated_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">info</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">info</span><span class="o">.</span><span class="n">initialized</span><span class="p">:</span>
            <span class="n">info</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">title</span> <span class="o">+=</span> <span class="s2">&quot;*&quot;</span>


<span class="k">class</span> <span class="nc">TestClass</span><span class="p">(</span><span class="n">HasTraits</span><span class="p">):</span>
    <span class="n">b1</span> <span class="o">=</span> <span class="n">Bool</span><span class="p">()</span>
    <span class="n">b2</span> <span class="o">=</span> <span class="n">Bool</span><span class="p">()</span>
    <span class="n">b3</span> <span class="o">=</span> <span class="n">Bool</span><span class="p">()</span>
    <span class="n">_updated</span> <span class="o">=</span> <span class="n">Bool</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>


<span class="n">view1</span> <span class="o">=</span> <span class="n">View</span><span class="p">(</span>
    <span class="s1">&#39;b1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;b2&#39;</span><span class="p">,</span>
    <span class="s1">&#39;b3&#39;</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Alter Title&quot;</span><span class="p">,</span>
    <span class="n">handler</span><span class="o">=</span><span class="n">TC_Handler</span><span class="p">(),</span>
    <span class="n">buttons</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;OK&#39;</span><span class="p">,</span> <span class="s1">&#39;Cancel&#39;</span><span class="p">],</span>
<span class="p">)</span>

<span class="n">tc</span> <span class="o">=</span> <span class="n">TestClass</span><span class="p">()</span>
<span class="n">tc</span><span class="o">.</span><span class="n">configure_traits</span><span class="p">(</span><span class="n">view</span><span class="o">=</span><span class="n">view1</span><span class="p">)</span>
</pre></div>
</div>
<img alt="Dialog box with empty checkboxes and a title of &quot;Alter Title&quot;" src="../_images/alter_title_before.png" />
<div class="figure align-default" id="id21">
<img alt="Dialog box with one filled checkbox and a title of &quot;Alter Title*&quot;" src="../_images/alter_title_after.png" />
<p class="caption"><span class="caption-text">Figure 7: Before and after views of Example 9</span><a class="headerlink" href="#id21" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="implementing-custom-window-commands">
<span id="id15"></span><h3>Implementing Custom Window Commands<a class="headerlink" href="#implementing-custom-window-commands" title="Permalink to this headline">¶</a></h3>
<p>Another use of a Handler is to define custom window
actions, which can be presented as buttons, menu items, or toolbar buttons.</p>
<div class="section" id="actions">
<span id="id16"></span><h4>Actions<a class="headerlink" href="#actions" title="Permalink to this headline">¶</a></h4>
<p>In TraitsUI, window commands are implemented as instances of the Action class.
Actions can be used in <a class="reference internal" href="glossary.html#term-command-button"><span class="xref std std-term">command button</span></a>s, menus, and toolbars.</p>
<p>Suppose you want to build a window with a custom <strong>Recalculate</strong> action. Suppose
further that you have defined a subclass of Handler called MyHandler to provide
the logic for the window. To create the action:</p>
<ol class="arabic">
<li><p>Add a method to MyHandler that implements the command logic. This method can
have any name (e.g., do_recalc()), but must accept exactly one argument: a
UIInfo object.</p></li>
<li><p>Create an Action instance using the name of the new method, e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">recalc</span> <span class="o">=</span> <span class="n">Action</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Recalculate&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;do_recalc&quot;</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="custom-command-buttons">
<span id="id17"></span><h4>Custom Command Buttons<a class="headerlink" href="#custom-command-buttons" title="Permalink to this headline">¶</a></h4>
<p>The simplest way to turn an Action into a window command is to add it to the
<strong>buttons</strong> attribute for the View. It appears in the button area of the window,
along with any standard buttons you specify.</p>
<ol class="arabic">
<li><p>Define the handler method and action, as described in <a class="reference internal" href="#actions"><span class="std std-ref">Actions</span></a>.</p></li>
<li><p>Include the new Action in the <strong>buttons</strong> attribute for the View:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">View</span><span class="p">(</span>
    <span class="c1"># view contents,</span>
    <span class="c1"># ...,</span>
    <span class="n">buttons</span><span class="o">=</span><span class="p">[</span><span class="n">OKButton</span><span class="p">,</span> <span class="n">CancelButton</span><span class="p">,</span> <span class="n">recalc</span><span class="p">],</span>
<span class="p">)</span>
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="menus-and-menu-bars">
<span id="id18"></span><h4>Menus and Menu Bars<a class="headerlink" href="#menus-and-menu-bars" title="Permalink to this headline">¶</a></h4>
<p>Another way to install an Action such as <strong>recalc</strong> as a window command is to
make it into a menu option.</p>
<ol class="arabic simple">
<li><p>Define the handler method and action, as described in <a class="reference internal" href="#actions"><span class="std std-ref">Actions</span></a>.</p></li>
<li><p>If the View does not already include a MenuBar, create one and assign it to
the View’s <strong>menubar</strong> attribute.</p></li>
<li><p>If the appropriate Menu does not yet exist, create it and add it to the
MenuBar.</p></li>
<li><p>Add the Action to the Menu.</p></li>
</ol>
<p>These steps can be executed all at once when the View is created, as in the
following code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">View</span><span class="p">(</span>
    <span class="c1"># view contents,</span>
    <span class="c1"># ...,</span>
    <span class="n">menubar</span><span class="o">=</span><span class="n">MenuBar</span><span class="p">(</span>
        <span class="n">Menu</span><span class="p">(</span><span class="n">my_action</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;My Special Menu&#39;</span><span class="p">),</span>
    <span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="toolbars">
<span id="id19"></span><h4>Toolbars<a class="headerlink" href="#toolbars" title="Permalink to this headline">¶</a></h4>
<p>A third way to add an action to a Traits View is to make it a button on a
toolbar. Adding a toolbar to a Traits View is similar to adding a menu bar,
except that toolbars do not contain menus; they directly contain actions.</p>
<ol class="arabic">
<li><p>Define the handler method and the action, as in <a class="reference internal" href="#actions"><span class="std std-ref">Actions</span></a>, including a
tooltip and an image to display on the toolbar. The image must be a Pyface
ImageResource instance; if a path to the image file is not specified, it is
assumed to be in an images subdirectory of the directory where ImageResource
is used:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">From</span> <span class="n">pyface</span><span class="o">.</span><span class="n">api</span> <span class="kn">import</span> <span class="nn">ImageResource</span>

<span class="n">recalc</span> <span class="o">=</span> <span class="n">Action</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Recalculate&quot;</span><span class="p">,</span>
    <span class="n">action</span><span class="o">=</span><span class="s2">&quot;do_recalc&quot;</span><span class="p">,</span>
    <span class="n">toolip</span><span class="o">=</span><span class="s2">&quot;Recalculate the results&quot;</span><span class="p">,</span>
    <span class="n">image</span><span class="o">=</span><span class="n">ImageResource</span><span class="p">(</span><span class="s2">&quot;recalc.png&quot;</span><span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>If the View does not already include a ToolBar, create one and assign it to
the View’s <strong>toolbar</strong> attribute.</p></li>
<li><p>Add the Action to the ToolBar.</p></li>
</ol>
<p>As with a MenuBar, these steps can be executed all at once when the View is
created, as in the following code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">View</span><span class="p">(</span>
   <span class="c1"># view contents,</span>
   <span class="c1"># ...,</span>
   <span class="n">toolbar</span><span class="o">=</span><span class="n">ToolBar</span><span class="p">(</span><span class="n">my_action</span><span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="undo-and-redo">
<span id="undo-redo"></span><h2>Undo and Redo<a class="headerlink" href="#undo-and-redo" title="Permalink to this headline">¶</a></h2>
<p>TraitsUI provides basic undo/redo functionality via the <a class="reference internal" href="../api/traitsui.ui.html#traitsui.ui.UI" title="traitsui.ui.UI"><code class="xref py py-class docutils literal notranslate"><span class="pre">UI</span></code></a> object’s history
trait.  This is created automatically for <a class="reference internal" href="../api/traitsui.view.html#traitsui.view.View" title="traitsui.view.View"><code class="xref py py-class docutils literal notranslate"><span class="pre">View</span></code></a> objects other than subpanels
whenever the <a class="reference internal" href="../api/traitsui.view.html#traitsui.view.View" title="traitsui.view.View"><code class="xref py py-class docutils literal notranslate"><span class="pre">View</span></code></a> has a menubar or an “Undo” or “Revert” button.  This
system is largely independent of the
<a class="reference external" href="https://docs.enthought.com/pyface/undo.html">Pyface undo/redo functionality</a>,
although that may change in the future.</p>
<p>The primary hook into the undo/redo system is via the <a class="reference internal" href="../api/traitsui.ui.html#traitsui.ui.UI.do_undoable" title="traitsui.ui.UI.do_undoable"><code class="xref py py-meth docutils literal notranslate"><span class="pre">do_undoable()</span></code></a> method of
the <a class="reference internal" href="../api/traitsui.ui.html#traitsui.ui.UI" title="traitsui.ui.UI"><code class="xref py py-class docutils literal notranslate"><span class="pre">UI</span></code></a> object, which calls the supplied callable while capturing all changes
to traits that are being viewed while the callable is running.  Undo and redo
actions then simply reset the values of all of those traits to the appropriate
before or after values.  This works well for simple cases where traits are not
heavily interdependent, but may break down in situations where there are
complex dependencies.</p>
<p>The <a class="reference internal" href="../api/traitsui.ui.html#traitsui.ui.UI.do_undoable" title="traitsui.ui.UI.do_undoable"><code class="xref py py-meth docutils literal notranslate"><span class="pre">do_undoable()</span></code></a> method is called when the value property of an <a class="reference internal" href="../api/traitsui.editor.html#traitsui.editor.Editor" title="traitsui.editor.Editor"><code class="xref py py-class docutils literal notranslate"><span class="pre">Editor</span></code></a> is
set or when any <a class="reference internal" href="../api/traitsui.menu.html#traitsui.menu.Action" title="traitsui.menu.Action"><code class="xref py py-class docutils literal notranslate"><span class="pre">Action</span></code></a> is performed, including actions associated with
complex editors that provide context menus.</p>
<p class="rubric">Footnotes</p>
<dl class="footnote brackets">
<dt class="label" id="id20"><span class="brackets"><a class="fn-backref" href="#id2">11</a></span></dt>
<dd><p>Except those implemented via the <strong>enabled_when</strong>, <strong>visible_when</strong>,
and <strong>defined_when</strong> attributes of Items and Groups.</p>
</dd>
</dl>
</div>
</div>


          </div>
        </div>
          </div>
      <div class="spc-rightsidebar span3">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/img/e-logo.png" alt="Logo">
            </a></p>
  <h3><a href="../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Controlling the Interface: the Handler</a><ul>
<li><a class="reference internal" href="#backstage-introducing-the-uiinfo-object">Backstage: Introducing the UIInfo Object</a></li>
<li><a class="reference internal" href="#backstage-the-ui-object">Backstage: The UI Object</a></li>
<li><a class="reference internal" href="#assigning-handlers-to-views">Assigning Handlers to Views</a><ul>
<li><a class="reference internal" href="#binding-a-singleton-handler-to-a-view">Binding a Singleton Handler to a View</a></li>
<li><a class="reference internal" href="#linking-handler-and-view-at-edit-time">Linking Handler and View at Edit Time</a></li>
<li><a class="reference internal" href="#creating-a-default-view-within-a-handler">Creating a Default View Within a Handler</a></li>
</ul>
</li>
<li><a class="reference internal" href="#handler-subclasses">Handler Subclasses</a><ul>
<li><a class="reference internal" href="#controller-class">Controller Class</a></li>
<li><a class="reference internal" href="#modelview-class">ModelView Class</a></li>
</ul>
</li>
<li><a class="reference internal" href="#writing-handler-methods">Writing Handler Methods</a><ul>
<li><a class="reference internal" href="#overriding-standard-methods">Overriding Standard Methods</a></li>
<li><a class="reference internal" href="#reacting-to-trait-changes">Reacting to Trait Changes</a></li>
<li><a class="reference internal" href="#implementing-custom-window-commands">Implementing Custom Window Commands</a><ul>
<li><a class="reference internal" href="#actions">Actions</a></li>
<li><a class="reference internal" href="#custom-command-buttons">Custom Command Buttons</a></li>
<li><a class="reference internal" href="#menus-and-menu-bars">Menus and Menu Bars</a></li>
<li><a class="reference internal" href="#toolbars">Toolbars</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#undo-and-redo">Undo and Redo</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="advanced_view.html"
                        title="previous chapter">Advanced View Concepts</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="factory_intro.html"
                        title="next chapter">Introduction to Trait Editor Factories</a></p>
  <h3>This Page</h3>
  <div>
    <a href="../_sources/traitsui_user_manual/handler.rst.txt"
       rel="nofollow">Show Source</a>
  </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
        </div>
      </div>
    </div>

    <div class="container container-navbar-bottom">
      <div class="spc-navbar">
        
      </div>
    </div>
    <div class="container">
    <div class="footer">
    <div class="row-fluid">
    <ul class="inline pull-left">
      <li>
        &copy; Copyright 2008-2022, Enthought
      </li>
      <li>
      Last updated on Mar 14, 2022.
      </li>
      <li>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 3.5.4.
      </li>
    </ul>
    </div>
    </div>
    </div>
  </body>
</html>